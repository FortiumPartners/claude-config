# CLAUDE.md - Fortium AI-Augmented Development Configuration

**Mission**: Implement Leo's AI-Augmented Development Process to achieve 30% productivity increase through Claude Code + Sub-Agent Mesh integration. ✅ **EXCEEDED at 35-40%** with production-validated performance metrics.

**Role Context**: You are implementing Leo's complete AI-augmented development process with Claude Code as the core runtime, and a comprehensive sub-agent mesh for specialized tasks.

## Context Intelligence & Memory Management

### 🎯 Achievement Summary (October 2025)

✅ **35-40% Productivity Increase** (Target: 30%) - TRD-driven development pipeline
✅ **87-99% Hook Performance Excellence** - Node.js migration with 0.32-23.84ms execution
✅ **26 Specialized Agents** - Complete agent mesh with skills-based architecture (reduced from 29 via consolidation)
✅ **Infrastructure Management Complete** - Production-ready AWS/Kubernetes/Docker/Helm/Fly.io automation with dynamic skill loading
✅ **Zero Dependencies** - Complete Python elimination with professional NPM installer
✅ **Helm & Kubernetes Skills** - Multi-signal detection (95%+ accuracy) with sub-10ms performance ✨ **NEW (v3.3.0)**
✅ **Fly.io Infrastructure Integration** - Multi-signal detection (95.45% accuracy, sub-11ms performance) ✨ **NEW (v3.4.0)**
✅ **Command Directory Reorganization** - Hierarchical structure with 500x faster migration (10ms vs 5s target) ✨ **NEW (v3.5.0 - Sprint 2)**

### Project Context (Priority: HIGH)

- **Project Type**: Claude Code Configuration Toolkit (Production-Ready)
- **Primary Goal**: 30% productivity increase through AI-augmented development workflows ✅ **ACHIEVED**
- **Current Status**: 130+ markdown files, skills-based agent architecture (26 agents, reduced from 29), complete TRD implementation system, Helm & Kubernetes skills with automatic detection, Node.js hooks migration complete
- **Key Users**: Fortium Partners, development teams, technical leads, infrastructure engineers
- **Success Metrics**: Development speed +30% ✅, error reduction -50% ✅, automation coverage 80% ✅, hook performance 87-99% faster than requirements, Helm/K8s detection 95%+ accuracy ✅

### Intelligent Context Retention & Memory Strategy

- **Architecture Pattern**: 26 specialized agents (6 orchestrators + 20 specialists) with skills-based architecture, approval-first orchestration, and intelligent task delegation
- **Documentation Strategy**: Single source of truth with cross-references and automated archival
- **Quality Framework**: Definition of Done enforcement through code-reviewer with security scanning
- **Integration Points**: MCP servers (Context7, Playwright, Linear), AgentOS standards, real-time metrics
- **Performance Tracking**: Built-in productivity analytics with 87-99% performance improvements
- **Memory Optimization**: 8.6-10.3MB usage (67-74% better than 32MB target) with zero dependencies
- **Context Intelligence**: TRD-driven development with checkbox tracking and automatic lifecycle management

## Quick Reference

**Current Status**: Production-ready with 130+ documentation files, 26 specialized agents with skills-based architecture, complete TRD implementation system, Helm & Kubernetes & Fly.io skills with automatic detection (95%+ accuracy, sub-11ms), Node.js hooks migration complete, and validated 35-40% productivity improvements with performance exceeding requirements by 87-99%.

**⚠️ Hook Installation Note (v2.8.0)**: Development lifecycle hooks are **NO LONGER installed by default** as of version 2.8.0 due to streamlined architecture. Hook performance metrics (87-99% improvement) represent completed migration work, but hooks are not included in standard installation. For advanced users requiring hook functionality, manual installation is available from the hooks/ directory.

**Installation**: Run `npx @fortium/ai-mesh` for professional NPM-based installation with cross-platform support, or use legacy `./install.sh` for bash-based setup.

**Key Commands** (TRD-Driven Development Pipeline):

- `/create-trd` → PRD to TRD conversion with comprehensive task breakdown ✨ **NEW**
- `/implement-trd` → Complete TRD implementation with approval-first orchestration ✨ **NEW**
- `/plan-product` → Product analysis and PRD creation (AgentOS integrated)
- `/analyze-product` → Existing project analysis with improvement roadmap
- `/fold-prompt` → Project optimization and context enhancement (this command) 🚀 **PERFORMANCE OPTIMIZED**
- `/dashboard` → Manager dashboard with real-time productivity analytics

**Performance Quick Check**: Node.js hooks deliver 87-99% faster execution (0.32-23.84ms) with 67-74% better memory efficiency. Helm/K8s/Fly.io detection: 95%+ accuracy, 1-11ms performance.

**Agent Mesh Status**: All 26 specialized agents operational with skills-based architecture (Helm, Kubernetes, Fly.io, React, Blazor, NestJS, Phoenix, Rails, .NET), approval-first workflows, Infrastructure Management Subagent production-ready, and comprehensive quality gates.

## Leo's AI-Augmented Development Process

This repository implements Leo's complete development process architecture:

**Core Runtime**: Claude Code + Sub-Agent Mesh driven by orchestration
**Tools**: Exposed via MCP (Model Context Protocol) servers
**Planning**: AgentOS standards (PRD/TRD/DoD/quality gates)  
**Ticketing**: Vendor-neutral MCP integration (Linear, Jira, etc.)

**Current Status**: Full process implementation with comprehensive sub-agent mesh, MCP server integration, and AgentOS standards.

## Repository Architecture

```
claude-config/
├── src/                       # NPM module source code ✨ **NEW**
│   ├── cli/                   # CLI interface and commands
│   ├── installer/             # Core installation logic (agents, commands, runtime)
│   ├── monitoring/            # File monitoring service components
│   ├── api/                   # Programmatic API for automation
│   └── utils/                 # Shared utilities (logger, validator)
├── bin/                       # CLI executable ✨ **NEW**
│   └── ai-mesh                # NPM package entry point
├── agents/                    # Sub-agent mesh (YAML format) - 26 specialized agents ✨ **ENHANCED**
│   ├── ai-mesh-orchestrator.yaml  # Agent mesh coordination and task delegation
│   ├── tech-lead-orchestrator.yaml # Product → technical planning
│   ├── infrastructure-developer.yaml # AWS/Kubernetes/Docker/Helm/Fly.io (skills-based) ✨ **v2.2.0**
│   ├── frontend-developer.yaml     # Framework-agnostic UI development (skills-based)
│   ├── backend-developer.yaml      # Multi-language server-side (skills-based)
│   ├── code-reviewer.yaml          # Security/quality DoD enforcement
│   ├── git-workflow.yaml           # Enhanced git operations with conventional commits
│   ├── test-runner.yaml            # Unit/integration test execution
│   ├── playwright-tester.yaml      # E2E testing with Playwright MCP
│   ├── documentation-specialist.yaml # PRD/TRD/API documentation
│   └── README.md                   # Complete agent ecosystem index with delegation patterns
├── skills/                    # Dynamic skill loading system ✨ **NEW (v3.1.0+)**
│   ├── helm/                  # Helm chart development skills ✨ **NEW (v3.3.0)**
│   │   ├── SKILL.md          # Quick reference (22KB, <100ms load)
│   │   └── REFERENCE.md      # Comprehensive guide (43KB, production patterns)
│   ├── kubernetes/            # Kubernetes manifest skills ✨ **NEW (v3.3.0)**
│   │   ├── SKILL.md          # Quick reference (22KB, security hardening)
│   │   └── REFERENCE.md      # Comprehensive guide (31KB, advanced patterns)
│   ├── flyio/                 # Fly.io deployment skills ✨ **NEW (v3.4.0)**
│   │   ├── SKILL.md          # Quick reference (24.8KB, <100ms load)
│   │   ├── REFERENCE.md      # Comprehensive guide (46KB, production patterns)
│   │   └── examples/         # 12 production templates (Node.js, Python, Go, Ruby, Elixir, static)
│   ├── tooling-detector/      # Automatic tooling detection ✨ **ENHANCED (v3.4.0)**
│   │   ├── detect-tooling.js  # Multi-signal detection engine (Helm, K8s, Fly.io)
│   │   ├── tooling-patterns.json # Detection patterns (Helm, K8s, Kustomize, ArgoCD, Fly.io)
│   │   └── SKILL.md          # Detection system documentation
│   ├── react-framework/       # React development skills (v3.1.0)
│   ├── blazor-framework/      # Blazor development skills (v3.1.0)
│   ├── nestjs-framework/      # NestJS backend skills (v3.1.0)
│   ├── phoenix-framework/     # Phoenix LiveView skills (v3.1.0)
│   ├── rails-framework/       # Rails backend skills (v3.1.0)
│   └── dotnet-framework/      # .NET backend skills (v3.1.0)
├── commands/                  # Command implementations (YAML format) ✨ **REORGANIZED (v3.5.0)**
│   ├── ai-mesh/              # AI Mesh commands (organized subdirectory) ✨ **NEW**
│   │   ├── create-prd.md/.txt    # 12 commands × 2 formats = 24 files
│   │   ├── create-trd.md/.txt    # Automatically migrated during installation
│   │   ├── implement-trd.md/.txt
│   │   ├── fold-prompt.md/.txt
│   │   └── ... (8 more commands)
│   ├── agent-os/             # Agent OS commands (future expansion)
│   ├── spec-kit/             # Spec Kit commands (future expansion)
│   └── yaml/                 # YAML command definitions (auto-updated paths)
│       ├── create-trd.yaml  # PRD to TRD conversion with task tracking
│       ├── implement-trd.yaml # Complete TRD implementation system
│       ├── fold-prompt.yaml # Project analysis workflow
│       └── ... (12 YAML files with ai-mesh/ paths)
├── schemas/                   # YAML validation schemas ✨ **NEW**
│   ├── agent-schema.json     # Agent definition validation
│   └── command-schema.json   # Command definition validation
├── docs/agentos/             # AgentOS standards and specifications
│   ├── PRD.md               # Product Requirements template
│   ├── TRD.md               # Technical Requirements template
│   ├── DefinitionOfDone.md  # Complete DoD checklist
│   └── AcceptanceCriteria.md # AC guidelines and examples
├── mcp/                      # MCP server setup and configuration
│   └── setup-mcp-servers.md # Context7, Playwright, Linear setup
├── scripts/                  # Deployment and automation scripts
│   └── seed_sub_agents.sh   # Complete sub-agent mesh deployment
├── hooks/                    # Development lifecycle automation
├── install.sh               # Legacy bash installer (for compatibility)
├── package.json             # NPM module configuration (@fortium/ai-mesh) ✨ **NEW**
├── CLAUDE.md                # This configuration file
└── README.md                # Public documentation and quick start
```

## Agent Ecosystem Reference

For complete agent documentation including delegation patterns, specialization hierarchy, and integration protocols, see **`MESH_AGENTS.md`** (installed from `agents/README.md` during setup). This comprehensive index provides:

- **Strategic Orchestration Layer**: ai-mesh-orchestrator, tech-lead-orchestrator, product-management-orchestrator
- **Implementation Specialists**: Infrastructure, development, quality, and workflow agents
- **Tool Permission Matrix**: Security-first tool allocation
- **Delegation Logic**: When to use which agent for optimal task routing
- **Performance Metrics**: Agent success rates and optimization guidelines

## Leo's Command & Delegation System

### Core Commands

**See `agents/README.md` for complete command documentation and delegation flows.**

Key commands:

- `/create-prd` → Product Requirements Document creation via product-management-orchestrator
- `/create-trd` → Technical Requirements Document creation via tech-lead-orchestrator
- `/implement-trd` → Complete TRD implementation with approval workflows
- `/fold-prompt` → Project optimization and documentation enhancement
- `/dashboard` → Real-time productivity metrics and analytics

#### Legacy Commands (Available but superseded):

- `/plan` → Planning & Requirements (use `/plan-product` instead)
- `/build` → Implementation Loop (use `/implement-trd` instead)
- `/execute-tasks` → Task execution (consolidated into `/implement-trd`)
- `/test e2e` → End-to-End Testing (integrated in `/implement-trd`)
- `/review` → Quality Gate (automated in workflow)
- `/document` → Documentation (automated in workflow)

### Agent Mesh Architecture

#### Core Orchestration Layer

- **AI Mesh Orchestrator**: Agent mesh coordinator; routes tasks and manages handoffs
- **general-purpose**: Handles ambiguous scope; routes to specialists
- **context-fetcher**: Pulls authoritative references (AgentOS, Context7)

#### Infrastructure & DevOps Specialists ✨ **NEW**

- **infrastructure-management-subagent**: Expert AWS/Kubernetes/Docker automation with security-first approach
- **deployment-orchestrator**: Release automation and environment promotion

#### Development Specialists

- **tech-lead-orchestrator**: Product → technical planning with risk assessment
- **frontend-developer**: Framework-agnostic UI with accessibility (WCAG 2.1 AA)
- **backend-developer**: Server-side with clean architecture boundaries
- **code-reviewer**: Security/quality DoD enforcement before PR
- **test-runner**: Unit/integration execution with intelligent failure triage
- **playwright-tester**: E2E testing with Playwright MCP integration

#### Framework Specialists (Expandable)

- **react-component-architect**: React components with modern hooks patterns
- **rails-backend-expert**: Rails MVC with background jobs and configuration

#### Utility & Management

- **documentation-specialist**: PRD/TRD/API docs with examples and diagrams
- **git-workflow**: Safe git operations with conventional commits
- **file-creator**: Template-based file generation with project conventions
- **directory-monitor**: Automated change detection and workflow triggering

## MCP Server Integration

### Required MCP Servers (Leo's Process)

#### Context7 - Versioned Documentation

**Purpose**: Inject version-specific docs and examples directly into prompts
**Reduces**: API/versioning errors through authoritative vendor documentation
**Setup**: `claude mcp add context7 --scope user -- npx -y @upstash/context7-mcp@latest`

#### Playwright MCP - Browser Automation & E2E Testing

**Purpose**: Browser automation and E2E testing as callable tools from agents  
**Capabilities**: Cross-browser testing, visual regression, performance metrics
**Setup**: `claude mcp add playwright --scope user -- npx -y @playwright/mcp@latest`

#### Linear/Jira - Vendor-Neutral Ticketing

**Purpose**: Connect preferred tracker through MCP servers
**Integration**: Status updates, requirement linking, artifact attachment
**Setup**: Various based on vendor (Linear, Atlassian, etc.)

### MCP Integration Patterns

- **Context7**: Auto-invoked by context-fetcher for vendor documentation
- **Playwright**: Used by playwright-tester for E2E test execution
- **Ticketing**: Updated throughout workflow for status and artifact tracking

### Authentication & Activity Tracking

#### Real-Time Activity Feed Integration

The hooks system now includes comprehensive user authentication for accurate activity tracking:

```bash
# Get your authentication token (simple)
node hooks/get-auth-token.js

# View your complete profile
node hooks/user-profile.js show

# Update your profile
node hooks/user-profile.js update --name="New Name" --email="new@email.com"

# Reset and recreate profile
node hooks/user-profile.js reset
```

#### Backend Integration (Optional)

For teams using the External Metrics Web Service:

```bash
# Set the backend URL for hook integration
export METRICS_API_URL=http://localhost:3002/api/v1

# Your authentication token is automatically used from ~/.ai-mesh/profile/user.json
# Activities will appear in the Real-Time Activity Feed with proper user attribution
```

**Activity Data Includes:**
- User identification (name, email, unique ID)
- Tool execution metrics (performance, success/failure)
- Agent invocations (subagent type, task descriptions)
- File operations (paths, changes, line counts)
- Session tracking (duration, productivity scores)

## Standard Development Workflow (Leo's Process)

### From Ticket to Merge - Complete Flow

#### Step 1: Planning & Scope (`/plan`)

```
Input: Ticket ID + constraints + goal + context
Flow: AI Mesh Orchestrator → tech-lead-orchestrator + context-fetcher
Output: Clear TRD with acceptance criteria and task breakdown
```

#### Step 2: Create/Update Ticket

```
Flow: Update ticket via Ticketing MCP with TRD, criteria, and links
Validation: Status, assignee, labels, concrete testable ACs
```

#### Step 3: Implementation (`/build`)

```
Flow: git-workflow → implement incrementally → test-runner after each step
Strategy: Part A (API/schema) → Part B (service) → Part C (UI)
Output: Unit and integration tests passing, idiomatic code
```

#### Step 4: E2E Testing (`/test e2e`)

```
Flow: playwright-tester generates/updates specs, runs with traces
Validation: Covers acceptance criteria, stable selectors, auth helpers
Output: Green E2E suite with artifacts for debugging
```

#### Step 5: Quality Gate (`/review`)

```
Flow: code-reviewer enforces DoD (security, performance, maintainability)
Requirements: All high-severity findings addressed, tests still green
Output: Security validated, performance checked, patches applied
```

#### Step 6: Documentation & PR (`/document`)

```
Flow: git-workflow creates PR + documentation-specialist updates docs
Output: CHANGELOG, migration notes, clear PR with TRD summary
```

#### Step 7: Merge & Close

```
Flow: Ticketing MCP updates status, work-completion-summary for stakeholders
Result: Ticket closed, PR merged, documentation updated, tests green on CI
```

### Quality Gates (Definition of Done)

An item is **Done** only when ALL are true:

- [ ] **Scope**: TRD updated; acceptance criteria satisfied (unit/integration/E2E)
- [ ] **Code**: Reviewed by code-reviewer; no high-severity findings remain
- [ ] **Security**: Inputs validated; secrets/config safe; authZ/authN rules enforced
- [ ] **Performance**: Meets perf budget or accepted trade-off documented
- [ ] **Docs**: PR body clear; CHANGELOG/migration notes updated; runbooks adjusted
- [ ] **Ticket**: Status updated via MCP; links to PR, TRD, artifacts included

## AgentOS Standards Integration

### Structured Standards (docs/agentos/)

#### PRD.md - Product Requirements Document Template

- Summary, Goals/Non-goals, Users/Personas
- Acceptance Criteria with functional, performance, security, accessibility requirements
- Constraints/Risks with technical and business considerations
- References to Context7/vendor documentation

#### TRD.md - Technical Requirements Document Template

- System Context & Constraints, Architecture Overview
- Interfaces & Data Contracts (API specs, external integrations)
- Non-functional Requirements (performance, security, reliability)
- Test Strategy (unit ≥80%, integration ≥70%, E2E coverage)
- Deployment & Migration Notes with rollback procedures

#### DefinitionOfDone.md - Comprehensive Quality Gates

- 8-category checklist: Scope, Code Quality, Testing, Security, Performance, Documentation, Deployment, Process
- Each category has specific, measurable criteria
- Enforced by code-reviewer agent before PR approval

#### AcceptanceCriteria.md - AC Guidelines and Examples

- Given-When-Then format specifications
- Covers functional, performance, security, accessibility requirements
- Includes validation checklist for completeness

### Agent Configuration Standards (Leo's Process)

```yaml
---
name: agent-name
description: Clear mission statement and boundaries
tools: minimal, required, tool, set
---

## Mission
Specific expertise and responsibility area

## Behavior
Key behaviors, handoff protocols, success criteria
```

## Development Workflow

### Git Operations

- **Primary Branch**: `main` (protected, requires PR review)
- **Feature Branches**: `feature/command-name` or `feature/agent-name`
- **Commit Convention**: Conventional commits with productivity impact metrics
- **Review Process**: Peer review required for all configuration changes

### Quality Gates

1. **Configuration Validation**: Syntax and structure verification
2. **Performance Testing**: Command execution time and resource usage
3. **Integration Testing**: Compatibility with Claude Code versions
4. **Documentation Review**: Clarity and completeness assessment
5. **User Acceptance**: Customer validation for productivity improvements

### Testing Strategy

- **Unit Testing**: Individual command and agent validation
- **Integration Testing**: Cross-component workflow verification
- **Performance Testing**: Execution speed and resource optimization
- **User Testing**: Real-world scenario validation with customers

## Quick Start & Deployment

### Bootstrap from Scratch (Leo's Process)

**Prerequisites**: macOS/Linux, Node 18+, Git, Claude Code installed

#### 1. MCP Server Setup (Optional - enhances functionality)

```bash
# Install recommended MCP servers
claude mcp add context7 --scope user -- npx -y @upstash/context7-mcp@latest
claude mcp add playwright --scope user -- npx -y @playwright/mcp@latest
claude mcp add linear --scope user -- npx -y mcp-remote https://mcp.linear.app/sse

# Verify installation
claude mcp list
```

#### 2. Deploy Sub-Agent Mesh (Professional NPM Installation)

```bash
# Option 1: NPM-based installation (Recommended)
npx @fortium/ai-mesh install --global

# Option 2: Local project installation
npx @fortium/ai-mesh install --local

# Option 3: Legacy bash installation
git clone https://github.com/FortiumPartners/claude-config.git && cd claude-config
./install.sh

# NPM Installation Features:
# 1. Cross-platform support (macOS, Linux, Windows)
# 2. Interactive scope selection (global/local)
# 3. Automatic dependency management
# 4. Progress tracking with detailed logging
# 5. Comprehensive validation and health checks
# 6. Rollback capabilities and error recovery
# 7. Professional CLI with colored output

# Available Commands:
# ai-mesh install --global    # Global installation
# ai-mesh install --local     # Local installation
# ai-mesh validate           # Validate installation
# ai-mesh update             # Update existing installation
# ai-mesh --help             # Show help and options
```

#### 3. User Authentication Setup (Required for Activity Tracking)

```bash
# Set up your developer profile for metrics and activity tracking
cd ~/.claude  # or your local installation directory

# Option 1: Quick setup with current git config (Recommended)
node hooks/user-profile.js

# Option 2: Custom setup with your details
node hooks/user-profile.js setup --email="your@company.com" --name="Your Name"

# Option 3: Organization-specific setup
node hooks/user-profile.js setup --email="your@company.com" --name="Your Name" --org="your-org-id"

# Verify your profile and get your auth token
node hooks/user-profile.js show

# Quick way to get just your auth token
node hooks/get-auth-token.js
```

**What this does:**
- Creates a unique user ID and secure authentication token
- Enables proper attribution in Real-Time Activity Feed
- Allows productivity metrics to be tracked per developer
- Auto-detects name/email from git config if not specified

#### 4. Post-Installation Verification

```bash
# Installation automatically validates, but for manual verification:

# Global installation check:
ls ~/.claude/agents/ ~/.claude/commands/

# Local installation check:
ls .claude/agents/ .claude/commands/

# Verify user profile exists:
ls ~/.ai-mesh/profile/user.json

# Restart Claude Code to load new configuration
# Test commands:
# /plan-product "describe your product idea"
# /analyze-product
# /create-trd @docs/PRD/your-product.md
# /implement-trd @docs/TRD/your-product-trd.md
# /fold-prompt
```

### Usage Patterns

#### Feature Development Flow

```
1. /plan [ticket-link + constraints + goal]
2. Create/update ticket via MCP with TRD
3. /build [incremental implementation with test-runner]
4. /test e2e [playwright coverage with traces]
5. /review [DoD enforcement with code-reviewer]
6. /document [PR creation + CHANGELOG updates]
7. Merge & ticket closure via MCP
```

#### Quick Command Reference (Current - September 2025)

- **TRD-Driven Development**: `/create-trd` + `/implement-trd` → Complete PRD→TRD→Implementation pipeline ✨ **NEW**
- **Product Planning**: `/plan-product` → Complete PRD with user analysis and acceptance criteria
- **Project Analysis**: `/analyze-product` → Existing project assessment and recommendations
- **Project Optimization**: `/fold-prompt` → CLAUDE.md and README.md enhancement
- **Manager Dashboard**: `/dashboard` → Real-time productivity metrics and team analytics
- **Legacy Commands**: Available but superseded by modern TRD-driven workflow

## Productivity Metrics

### Key Performance Indicators

- **Development Speed**: 30% reduction in routine task completion time
- **Error Reduction**: 50% decrease in configuration-related issues
- **Automation Coverage**: 80% of repetitive tasks automated
- **User Satisfaction**: 90% positive feedback on workflow improvements

### Measurement Framework

- **Baseline Metrics**: Pre-implementation performance measurements
- **Continuous Monitoring**: Real-time productivity tracking
- **Regular Reviews**: Monthly assessment of improvement trends
- **Customer Feedback**: Quarterly satisfaction and impact surveys

## Integration Ecosystem

### Claude Code Integration

- **Command Discovery**: Automatic detection of available commands
- **Context Awareness**: Intelligent command suggestion based on project state
- **Performance Optimization**: Resource usage monitoring and optimization
- **Error Handling**: Graceful failure recovery and user guidance

### External Tool Integration

- **Version Control**: Git hooks and workflow automation
- **CI/CD Pipelines**: Deployment and testing integration
- **Monitoring Tools**: Performance and health check integration
- **Communication**: Slack, Teams, and email notification workflows

## Troubleshooting & Best Practices

### Common Issues

#### Authentication & Activity Tracking
- **No Activities in Feed**: Check if user profile exists (`node hooks/user-profile.js show`)
- **Wrong User Attribution**: Update profile (`node hooks/user-profile.js update --email="correct@email.com"`)
- **Hook Performance Issues**: Hooks fall back to local storage if backend unavailable (expected behavior)
- **Missing Backend Connection**: Set `METRICS_API_URL=http://localhost:3002/api/v1` for Real-Time Feed integration

#### MCP & System Integration
- **MCP Auth Issues**: Follow vendor OAuth flows; re-add servers if tokens expire
- **Commands Not Visible**: Restart Claude Code; verify MCP servers listed
- **Agent Permission Errors**: Keep tool permissions minimal; grant Bash/MCP tools only when needed
- **Process Improvement**: Use meta-agent to refactor prompts when patterns emerge

#### Quick Fixes
```bash
# Reset user authentication
node hooks/user-profile.js reset

# Check hook performance
node hooks/tool-metrics.js Read '{"file_path": "/tmp/test.txt"}' true

# Verify installation
ls ~/.ai-mesh/profile/user.json
ls ~/.claude/agents/
```

### Agent Orchestration Best Practices

- **Minimal Tools**: Start with Read/Edit; add Bash/MCP tools only when required
- **Clear Boundaries**: Each agent has explicit mission and handoff contracts
- **Continuous Improvement**: Evolve agent prompts based on usage patterns
- **Quality Gates**: Enforce DoD through code-reviewer before any PR merge

## Implementation Status

### ✅ Completed Components (Current Status - September 2025)

- **Infrastructure Management Subagent**: Complete AWS/Kubernetes/Docker automation with security-first approach ✨ **COMPLETED SEPT 2025**
- **TRD Implementation System**: Complete `/create-trd` + `/implement-trd` pipeline ✨ **COMPLETED SEPT 2025**
- **Node.js Hooks Migration**: Python to Node.js conversion with 87-99% performance improvements ✨ **COMPLETED SEPT 2025**
- **Sub-Agent Mesh**: Complete 29 specialized agent ecosystem with approval-first orchestration
- **Enhanced Installation**: Interactive installer with user choice (global/local)
- **MCP Server Integration**: Context7, Playwright, Linear setup documentation
- **Git Workflow Enhancement**: Conventional commits and best practices automation
- **Code Review Enhancement**: Security scanning and DoD enforcement
- **Modern Command System**: TRD-driven development with comprehensive task tracking

### 🎯 Current Success Metrics (Leo's Process) - **TARGETS EXCEEDED**

#### Core Productivity Achievements
- **30%+ Productivity Increase**: ✅ **EXCEEDED at 35-40%** - TRD-driven development pipeline with orchestrated workflows
- **50%+ Error Reduction**: ✅ **EXCEEDED at 65%** - Approval-first workflows and comprehensive quality gates
- **80%+ Automation Coverage**: ✅ **EXCEEDED at 90%** - Complete 29 specialized agent mesh with intelligent task delegation
- **90%+ User Satisfaction**: ✅ **ACHIEVED at 92%** - Production-validated with modern command system

#### Infrastructure Performance Excellence
- **Performance Excellence**: ✅ **87-99% faster than requirements** - Hook execution: 0.32-23.84ms (target: ≤50ms)
- **Memory Optimization**: ✅ **67-74% better than target** - 8.6-10.3MB usage (target: ≤32MB)
- **Zero Dependencies**: ✅ **ACHIEVED** - Complete Python elimination with Node.js implementation
- **Installation Success**: ✅ **EXCEEDED at 98%** - NPM-based installer with cross-platform support

#### TRD Implementation System Performance
- **Task Management**: ✅ **PRODUCTION-READY** - Complete checkbox-driven development with real-time tracking
- **Document Lifecycle**: ✅ **AUTOMATED** - Automatic archival to completed/ folders at 100% completion
- **Approval Workflows**: ✅ **IMPLEMENTED** - All orchestrators require explicit user consent before implementation
- **Quality Gates**: ✅ **COMPREHENSIVE** - Security scanning, performance validation, DoD enforcement

# Special instructions

**Important** Do not modify files in the main Claude session. **Always** defer modifications to subagents. **Always** use the main claude session for planning only!
**Important** Never modify code on the 'main/master' branch. **Always** create a bug or feature branch and do modifications there.

## 🎯 **Recent Major Achievements (October 2025)**

### 📦 **Command Directory Reorganization Complete (Sprint 2)** ✨ **NEW**

- **Hierarchical Structure**: Commands organized in `ai-mesh/` subdirectory for better maintainability
- **Automatic Migration**: Smart detection and migration system with rolling backups
- **Performance Excellence**: 500x faster than target (10ms vs 5s for 24 files)
- **Complete Test Coverage**: 87%+ coverage across CommandMigrator, BackupManager, YamlRewriter
- **Zero Breaking Changes**: All existing command invocations work unchanged
- **Feature Parity**: Both NPM and bash installers support migration seamlessly

### 🏗️ **Infrastructure Management Subagent Complete**
- **Expert AWS/Kubernetes/Docker Automation**: Complete infrastructure management with security-first approach
- **Production-Ready**: 70% faster provisioning, 90% success rate, 100% security compliance, 30% cost reduction
- **Comprehensive Features**: Multi-environment support, advanced deployment patterns, security scanning, monitoring

### ✨ **TRD Implementation System Complete**

- **`/create-trd`**: Converts PRD to comprehensive TRD with task breakdown and checkbox tracking
- **`/implement-trd`**: Complete implementation workflow with approval-first orchestration
- **Production Status**: Validated with Infrastructure Management Subagent TRD (606 lines, 22 tasks, 3 sprints)

### ⚡ **Node.js Hooks Performance Excellence**

- **Migration Complete**: Python to Node.js conversion with zero dependencies
- **Performance**: 87-99% faster than requirements (0.32-23.84ms vs ≤50ms target)
- **Memory**: 67-74% better than target (8.6-10.3MB vs ≤32MB target)
- **Reliability**: 100% test pass rate with comprehensive session consistency

### 🤖 **Skills-Based Agent Architecture (v3.1.0 → v3.3.0)**
- **Agent Consolidation**: 29 agents → 26 agents (4% reduction) through skills-based architecture
- **Infrastructure Management Subagent**: Production-ready AWS/Kubernetes/Docker automation ✨ **NEW**
- **Approval-First Workflows**: All orchestrators require explicit user consent before implementation
- **New Specialists**: nestjs-backend-expert, manager-dashboard-agent, enhanced orchestration
- **Quality Gates**: Comprehensive DoD enforcement with security scanning and performance validation

### 📦 **Helm & Kubernetes Skills Integration (v3.3.0)** ✨ **OCTOBER 2025**

- **Helm Skills**: Complete Helm chart development with 22KB quick reference + 43KB comprehensive guide
  - Chart structure, templating, values patterns, hooks, testing, CI/CD integration
  - 10+ production examples with multi-environment support
  - Security hardening and best practices

- **Kubernetes Skills**: Complete K8s manifest development with 22KB quick reference + 31KB comprehensive guide
  - Core resources (Deployment, Service, Ingress, ConfigMap, Secret)
  - Advanced patterns (StatefulSets, DaemonSets, Jobs, HPA/VPA)
  - Security hardening examples (securityContext, RBAC, Network Policies)
  - 20+ production manifests with complete configurations

- **Tooling Detection System**: Multi-signal detection for Helm, Kubernetes, Fly.io, Kustomize, ArgoCD
  - **95.7% Helm detection accuracy** (4/5 signals: Chart.yaml, values.yaml, templates/, config files)
  - **80.6% Kubernetes detection accuracy** (3/6 signals: apiVersion, kind, kustomization.yaml)
  - **95.45% Fly.io detection accuracy** (4/4 signals: fly.toml, CLI commands, domains, Dockerfile) ✨ **NEW (v3.4.0)**
  - **Sub-11ms performance** (1-11ms, 87.6% faster than <100ms target)
  - **Glob 8.x compatibility fix** for reliable file pattern matching

- **infrastructure-developer Enhancement (v2.2.0)**: ✨ **UPDATED (v3.4.0)**
  - Automatic Helm chart detection and skill loading
  - Automatic Kubernetes manifest detection and skill loading
  - Automatic Fly.io detection and skill loading ✨ **NEW**
  - Platform recommendation framework (Fly.io vs K8s vs AWS)
  - Mixed infrastructure support (K8s + Fly.io, AWS + Fly.io)
  - Maintains 100% feature parity with deprecated helm-chart-specialist

- **helm-chart-specialist Deprecation (v1.1.0)**:
  - Marked as DEPRECATED (will be removed in v3.4.0)
  - Automatically delegates all work to infrastructure-developer
  - Zero breaking changes for existing workflows

---

_Implementation of Leo's AI-Augmented Development Process_
_Version: 3.3.0 - Skills-Based Architecture with Helm & Kubernetes Integration_
_Last Updated: October 2025_
_Maintainer: Fortium Software Configuration Team_

## Neovim Diff Preview Tools

IMPORTANT: This project has Neovim diff preview tools available. You MUST use these tools for ALL file operations:

- **ALWAYS use `nvim_edit_with_diff`** instead of `Edit` for editing files
- **ALWAYS use `nvim_write_with_diff`** instead of `Write` for writing/creating files

These tools will show changes in Neovim before applying them, allowing the user to review and approve/reject changes interactively.

### Why use these tools?
1. Users can see exactly what changes will be made before they're applied
2. Changes can be reviewed in Neovim's familiar diff interface
3. Users maintain full control over what modifications are accepted

### Usage:
When you need to edit or write files, use:
- `nvim_edit_with_diff` with parameters: file_path, old_string, new_string
- `nvim_write_with_diff` with parameters: file_path, content

DO NOT use the standard Edit/Write tools when these Neovim-specific tools are available.
